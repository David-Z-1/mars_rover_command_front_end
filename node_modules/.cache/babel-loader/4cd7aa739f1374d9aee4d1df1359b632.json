{"ast":null,"code":"var _jsxFileName = \"/Users/david/Desktop/mars_rover_command_front_end/src/components/Rover_Map.tsx\",\n    _s = $RefreshSig$(),\n    _s2 = $RefreshSig$();\n\nimport React, { useState, useEffect, useRef, useCallback } from 'react';\nimport axios from 'axios';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nvar x_previous;\nvar y_previous;\nvar rover_x;\nvar rover_y;\nvar alien_x;\nvar alien_y;\nvar color;\nvar id_rover_array = new Array();\nvar id_alien_array = new Array(); //force useEffect to render (useful because useRef will prevent the change being noticed)\n\nexport function useForceUpdate() {\n  _s();\n\n  const [, setTick] = useState(0);\n  const update = useCallback(() => {\n    setTick(tick => tick + 1);\n  }, []);\n  return update;\n} //define canvas\n\n_s(useForceUpdate, \"C/PHpCb03UdT1Zvs8guPjcg6YZY=\");\n\n//main function\nconst Rover_Map = _ref => {\n  _s2();\n\n  let {\n    width,\n    height\n  } = _ref;\n  const forceUpdate = useForceUpdate();\n  const [roverlocatex, setRoverlocateX] = useState([0]);\n  const [roverlocatey, setRoverlocateY] = useState([0]);\n  const [alienlocatex, setAlienlocateX] = useState([0]);\n  const [alienlocatey, setAlienlocateY] = useState([0]);\n  const [aliencolor, setAliencolor] = useState([]);\n  const canvasRef = useRef(null);\n  useEffect(() => {\n    //obtain coordinates from database --------- rover location\n    const FetchRoverData = async () => {\n      try {\n        const res = await axios.get('http://localhost:8000/rover');\n        setRoverlocateX(res.data[0]['x-axis']);\n        setRoverlocateY(res.data[0]['y-axis']); // if(id_rover_array.indexOf((res.data)[0]['id']) == -1){\n        //     console.log(\"rover id update\")\n        //     id_rover_array.push((res.data)[0]['id'])\n        //     forceUpdate();\n        // }\n        // else {\n        //     console.log(\"rover id exist\")\n        // }\n      } catch (error) {\n        console.log(error);\n      }\n    }; //obtain coordinates from database --------- alien location\n\n\n    const FetchAlienData = async () => {\n      try {\n        const res1 = await axios.get('http://localhost:8000/mapalien');\n        setAlienlocateX(res1.data[0]['x-axis']);\n        setAlienlocateY(res1.data[0]['y-axis']);\n        setAliencolor(res1.data[0]['color']); // if(id_alien_array.indexOf((res1.data)[0]['id']) == -1){\n        //     forceUpdate();\n        //     id_alien_array.push((res1.data)[0]['id'])\n        // }\n        // else {\n        //     console.log(\"alien id exist\")\n        // }\n      } catch (error) {\n        console.log(error);\n      }\n    }; //obtain coordinates where image is displayed --------- rover location\n\n\n    var roverlocate_x = roverlocatex.toString().split(\"\");\n    var roverlocate_y = roverlocatey.toString().split(\"\");\n\n    if (rover_x !== 5 + parseInt(roverlocate_x.join(\"\")) || rover_y !== 5 + parseInt(roverlocate_y.join(\"\"))) {\n      x_previous = rover_x;\n      y_previous = rover_y;\n    }\n\n    rover_x = 5 + parseInt(roverlocate_x.join(\"\")); //+5: make sure full image/circle is displayed\n\n    rover_y = 5 + parseInt(roverlocate_y.join(\"\")); //obtain coordinates where image is displayed --------- alien location\n\n    var alienlocate_x = alienlocatex.toString().split(\"\");\n    var alienlocate_y = alienlocatey.toString().split(\"\");\n    alien_x = 5 + parseInt(alienlocate_x.join(\"\"));\n    alien_y = 5 + parseInt(alienlocate_y.join(\"\"));\n    var alien_color = aliencolor.toString().split(\"\");\n    color = alien_color.join(\"\"); //clear previous image & draw new image --------- rover location\n\n    if (canvasRef.current) {\n      var canvas = canvasRef.current;\n      var rover_position = canvas.getContext('2d');\n      var tmp = {\n        //use to resize image\n        width: 0,\n        height: 0\n      };\n      forceUpdate();\n      var img = new Image();\n      img.src = 'image.png';\n      tmp.width = Math.floor(img.width * 0.03);\n      tmp.height = Math.floor(img.height * 0.025);\n      rover_position.clearRect(x_previous, y_previous, tmp.width, tmp.height);\n      console.log('clear: x_pre-', x_previous, 'y_pre-', y_previous); // for debug\n\n      img.onload = function () {\n        if (rover_x !== 10 && rover_y !== 10) {\n          rover_position.drawImage(img, rover_x, rover_y, tmp.width, tmp.height);\n        }\n      };\n\n      console.log('draw: x-', rover_x, 'y-', rover_y); // for debug\n      //clear previous image & draw new image --------- alien location\n\n      if (rover_position && (alien_x != 5 || alien_y != 5)) {\n        rover_position.beginPath();\n        rover_position.arc(alien_x, alien_y, 5, 0, 2 * Math.PI);\n        console.log('color', color); // for debug\n\n        rover_position.fillStyle = color;\n        rover_position.fill();\n        rover_position.stroke();\n      } else {\n        console.log('error loading context');\n      }\n    }\n\n    FetchRoverData();\n    FetchAlienData();\n  });\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: /*#__PURE__*/_jsxDEV(\"canvas\", {\n      ref: canvasRef,\n      height: height,\n      width: width\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 142,\n      columnNumber: 13\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 141,\n    columnNumber: 9\n  }, this);\n}; //canvas size\n\n\n_s2(Rover_Map, \"5UZ7AynvCFeN+vQwOrUlUNNzyxk=\", false, function () {\n  return [useForceUpdate];\n});\n\n_c = Rover_Map;\nRover_Map.defaultProps = {\n  width: 400,\n  height: 500\n};\nexport default Rover_Map;\n\nvar _c;\n\n$RefreshReg$(_c, \"Rover_Map\");","map":{"version":3,"names":["React","useState","useEffect","useRef","useCallback","axios","x_previous","y_previous","rover_x","rover_y","alien_x","alien_y","color","id_rover_array","Array","id_alien_array","useForceUpdate","setTick","update","tick","Rover_Map","width","height","forceUpdate","roverlocatex","setRoverlocateX","roverlocatey","setRoverlocateY","alienlocatex","setAlienlocateX","alienlocatey","setAlienlocateY","aliencolor","setAliencolor","canvasRef","FetchRoverData","res","get","data","error","console","log","FetchAlienData","res1","roverlocate_x","toString","split","roverlocate_y","parseInt","join","alienlocate_x","alienlocate_y","alien_color","current","canvas","rover_position","getContext","tmp","img","Image","src","Math","floor","clearRect","onload","drawImage","beginPath","arc","PI","fillStyle","fill","stroke","defaultProps"],"sources":["/Users/david/Desktop/mars_rover_command_front_end/src/components/Rover_Map.tsx"],"sourcesContent":["import React,{useState,useEffect,useRef,useCallback} from 'react'\nimport axios from 'axios'\nvar x_previous: number;\nvar y_previous: number;\nvar rover_x: number;\nvar rover_y: number;\nvar alien_x: number;\nvar alien_y: number;\nvar color: string;\n\nvar id_rover_array = new Array<number>();\nvar id_alien_array = new Array<number>();\n\n//force useEffect to render (useful because useRef will prevent the change being noticed)\nexport function useForceUpdate() {\n  const [, setTick] = useState(0);\n  const update = useCallback(() => {\n    setTick(tick => tick + 1);\n  }, [])\n  return update;\n}\n\n//define canvas\ninterface CanvasProps {\n    width: number;\n    height: number;\n}\n\n//main function\nconst Rover_Map = ({ width, height }: CanvasProps) => {\n\n    const forceUpdate = useForceUpdate();\n\n    const [roverlocatex, setRoverlocateX] = useState<number[]>([0]);\n    const [roverlocatey, setRoverlocateY] = useState<number[]>([0]);\n\n    const [alienlocatex, setAlienlocateX] = useState<number[]>([0]);\n    const [alienlocatey, setAlienlocateY] = useState<number[]>([0]);\n    const [aliencolor, setAliencolor] = useState<string[]>([]);\n\n    const canvasRef = useRef<HTMLCanvasElement>(null);\n\n    useEffect(() => {\n\n        //obtain coordinates from database --------- rover location\n        const FetchRoverData = async () => {\n            try {\n                const res = await axios.get('http://localhost:8000/rover')\n\n                setRoverlocateX((res.data)[0]['x-axis'])\n                setRoverlocateY((res.data)[0]['y-axis'])\n\n                // if(id_rover_array.indexOf((res.data)[0]['id']) == -1){\n                //     console.log(\"rover id update\")\n                //     id_rover_array.push((res.data)[0]['id'])\n                //     forceUpdate();\n                // }\n                // else {\n                //     console.log(\"rover id exist\")\n                // }\n            } \n            catch (error) {\n                console.log(error)\n            }\n        }\n\n        //obtain coordinates from database --------- alien location\n        const FetchAlienData = async () => {\n            try {\n                const res1 = await axios.get('http://localhost:8000/mapalien')\n                setAlienlocateX((res1.data)[0]['x-axis'])\n                setAlienlocateY((res1.data)[0]['y-axis'])\n                setAliencolor((res1.data)[0]['color'])\n                // if(id_alien_array.indexOf((res1.data)[0]['id']) == -1){\n                //     forceUpdate();\n                //     id_alien_array.push((res1.data)[0]['id'])\n                // }\n                // else {\n                //     console.log(\"alien id exist\")\n                // }\n            }\n            catch (error) {\n                console.log(error)\n            }\n        }\n\n        //obtain coordinates where image is displayed --------- rover location\n        var roverlocate_x = roverlocatex.toString().split(\"\")\n        var roverlocate_y = roverlocatey.toString().split(\"\")\n        if (rover_x!==5+parseInt(roverlocate_x.join(\"\")) || rover_y!==5+parseInt(roverlocate_y.join(\"\")) ){\n            x_previous=rover_x\n            y_previous=rover_y}\n        rover_x = 5+parseInt(roverlocate_x.join(\"\"))    //+5: make sure full image/circle is displayed\n        rover_y = 5+parseInt(roverlocate_y.join(\"\"))\n\n        //obtain coordinates where image is displayed --------- alien location\n        var alienlocate_x = alienlocatex.toString().split(\"\")\n        var alienlocate_y = alienlocatey.toString().split(\"\")\n        alien_x = 5+parseInt(alienlocate_x.join(\"\"))\n        alien_y = 5+parseInt(alienlocate_y.join(\"\"))\n        var alien_color = aliencolor.toString().split(\"\")\n        color = alien_color.join(\"\")\n\n\n        //clear previous image & draw new image --------- rover location\n        if (canvasRef.current) {\n            var canvas = canvasRef.current;\n            var rover_position = canvas.getContext('2d');  \n            var tmp = {     //use to resize image\n                width: 0,\n                height:0 }\n            forceUpdate();\n            var img = new Image();\n            img.src = 'image.png';\n            tmp.width=Math.floor(img.width * 0.03)\n            tmp.height=Math.floor(img.height * 0.025)\n            rover_position!.clearRect(x_previous, y_previous, tmp.width, tmp.height);\n            console.log('clear: x_pre-',x_previous, 'y_pre-', y_previous)  // for debug\n            img.onload = function() {\n                if(rover_x!==10 && rover_y!==10){\n                    rover_position!.drawImage(img, rover_x, rover_y, tmp.width,  tmp.height);}\n            };\n            console.log('draw: x-',rover_x, 'y-', rover_y);  // for debug\n\n            //clear previous image & draw new image --------- alien location\n            if(rover_position && (alien_x!=5 || alien_y!=5)){\n                rover_position.beginPath();\n                rover_position.arc(alien_x, alien_y, 5, 0, 2*Math.PI);\n                console.log('color', color);  // for debug\n                rover_position.fillStyle = color\n                rover_position.fill();\n                rover_position.stroke();\n            }   else {console.log('error loading context')}\n\n        }       \n        FetchRoverData()\n        FetchAlienData()\n    } );\n\n    return (\n        <div>\n            <canvas ref={canvasRef} height={height} width={width} />\n            {/* <h1> {roverlocatex}, {roverlocatey} </h1>*/}\n        </div>\n    );\n};\n\n//canvas size\nRover_Map.defaultProps = {\n    width: 400,\n    height: 500,\n};\n\nexport default Rover_Map;"],"mappings":";;;;AAAA,OAAOA,KAAP,IAAcC,QAAd,EAAuBC,SAAvB,EAAiCC,MAAjC,EAAwCC,WAAxC,QAA0D,OAA1D;AACA,OAAOC,KAAP,MAAkB,OAAlB;;AACA,IAAIC,UAAJ;AACA,IAAIC,UAAJ;AACA,IAAIC,OAAJ;AACA,IAAIC,OAAJ;AACA,IAAIC,OAAJ;AACA,IAAIC,OAAJ;AACA,IAAIC,KAAJ;AAEA,IAAIC,cAAc,GAAG,IAAIC,KAAJ,EAArB;AACA,IAAIC,cAAc,GAAG,IAAID,KAAJ,EAArB,C,CAEA;;AACA,OAAO,SAASE,cAAT,GAA0B;EAAA;;EAC/B,MAAM,GAAGC,OAAH,IAAchB,QAAQ,CAAC,CAAD,CAA5B;EACA,MAAMiB,MAAM,GAAGd,WAAW,CAAC,MAAM;IAC/Ba,OAAO,CAACE,IAAI,IAAIA,IAAI,GAAG,CAAhB,CAAP;EACD,CAFyB,EAEvB,EAFuB,CAA1B;EAGA,OAAOD,MAAP;AACD,C,CAED;;GARgBF,c;;AAchB;AACA,MAAMI,SAAS,GAAG,QAAoC;EAAA;;EAAA,IAAnC;IAAEC,KAAF;IAASC;EAAT,CAAmC;EAElD,MAAMC,WAAW,GAAGP,cAAc,EAAlC;EAEA,MAAM,CAACQ,YAAD,EAAeC,eAAf,IAAkCxB,QAAQ,CAAW,CAAC,CAAD,CAAX,CAAhD;EACA,MAAM,CAACyB,YAAD,EAAeC,eAAf,IAAkC1B,QAAQ,CAAW,CAAC,CAAD,CAAX,CAAhD;EAEA,MAAM,CAAC2B,YAAD,EAAeC,eAAf,IAAkC5B,QAAQ,CAAW,CAAC,CAAD,CAAX,CAAhD;EACA,MAAM,CAAC6B,YAAD,EAAeC,eAAf,IAAkC9B,QAAQ,CAAW,CAAC,CAAD,CAAX,CAAhD;EACA,MAAM,CAAC+B,UAAD,EAAaC,aAAb,IAA8BhC,QAAQ,CAAW,EAAX,CAA5C;EAEA,MAAMiC,SAAS,GAAG/B,MAAM,CAAoB,IAApB,CAAxB;EAEAD,SAAS,CAAC,MAAM;IAEZ;IACA,MAAMiC,cAAc,GAAG,YAAY;MAC/B,IAAI;QACA,MAAMC,GAAG,GAAG,MAAM/B,KAAK,CAACgC,GAAN,CAAU,6BAAV,CAAlB;QAEAZ,eAAe,CAAEW,GAAG,CAACE,IAAL,CAAW,CAAX,EAAc,QAAd,CAAD,CAAf;QACAX,eAAe,CAAES,GAAG,CAACE,IAAL,CAAW,CAAX,EAAc,QAAd,CAAD,CAAf,CAJA,CAMA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;MACH,CAdD,CAeA,OAAOC,KAAP,EAAc;QACVC,OAAO,CAACC,GAAR,CAAYF,KAAZ;MACH;IACJ,CAnBD,CAHY,CAwBZ;;;IACA,MAAMG,cAAc,GAAG,YAAY;MAC/B,IAAI;QACA,MAAMC,IAAI,GAAG,MAAMtC,KAAK,CAACgC,GAAN,CAAU,gCAAV,CAAnB;QACAR,eAAe,CAAEc,IAAI,CAACL,IAAN,CAAY,CAAZ,EAAe,QAAf,CAAD,CAAf;QACAP,eAAe,CAAEY,IAAI,CAACL,IAAN,CAAY,CAAZ,EAAe,QAAf,CAAD,CAAf;QACAL,aAAa,CAAEU,IAAI,CAACL,IAAN,CAAY,CAAZ,EAAe,OAAf,CAAD,CAAb,CAJA,CAKA;QACA;QACA;QACA;QACA;QACA;QACA;MACH,CAZD,CAaA,OAAOC,KAAP,EAAc;QACVC,OAAO,CAACC,GAAR,CAAYF,KAAZ;MACH;IACJ,CAjBD,CAzBY,CA4CZ;;;IACA,IAAIK,aAAa,GAAGpB,YAAY,CAACqB,QAAb,GAAwBC,KAAxB,CAA8B,EAA9B,CAApB;IACA,IAAIC,aAAa,GAAGrB,YAAY,CAACmB,QAAb,GAAwBC,KAAxB,CAA8B,EAA9B,CAApB;;IACA,IAAItC,OAAO,KAAG,IAAEwC,QAAQ,CAACJ,aAAa,CAACK,IAAd,CAAmB,EAAnB,CAAD,CAApB,IAAgDxC,OAAO,KAAG,IAAEuC,QAAQ,CAACD,aAAa,CAACE,IAAd,CAAmB,EAAnB,CAAD,CAAxE,EAAkG;MAC9F3C,UAAU,GAACE,OAAX;MACAD,UAAU,GAACE,OAAX;IAAmB;;IACvBD,OAAO,GAAG,IAAEwC,QAAQ,CAACJ,aAAa,CAACK,IAAd,CAAmB,EAAnB,CAAD,CAApB,CAlDY,CAkDoC;;IAChDxC,OAAO,GAAG,IAAEuC,QAAQ,CAACD,aAAa,CAACE,IAAd,CAAmB,EAAnB,CAAD,CAApB,CAnDY,CAqDZ;;IACA,IAAIC,aAAa,GAAGtB,YAAY,CAACiB,QAAb,GAAwBC,KAAxB,CAA8B,EAA9B,CAApB;IACA,IAAIK,aAAa,GAAGrB,YAAY,CAACe,QAAb,GAAwBC,KAAxB,CAA8B,EAA9B,CAApB;IACApC,OAAO,GAAG,IAAEsC,QAAQ,CAACE,aAAa,CAACD,IAAd,CAAmB,EAAnB,CAAD,CAApB;IACAtC,OAAO,GAAG,IAAEqC,QAAQ,CAACG,aAAa,CAACF,IAAd,CAAmB,EAAnB,CAAD,CAApB;IACA,IAAIG,WAAW,GAAGpB,UAAU,CAACa,QAAX,GAAsBC,KAAtB,CAA4B,EAA5B,CAAlB;IACAlC,KAAK,GAAGwC,WAAW,CAACH,IAAZ,CAAiB,EAAjB,CAAR,CA3DY,CA8DZ;;IACA,IAAIf,SAAS,CAACmB,OAAd,EAAuB;MACnB,IAAIC,MAAM,GAAGpB,SAAS,CAACmB,OAAvB;MACA,IAAIE,cAAc,GAAGD,MAAM,CAACE,UAAP,CAAkB,IAAlB,CAArB;MACA,IAAIC,GAAG,GAAG;QAAM;QACZpC,KAAK,EAAE,CADD;QAENC,MAAM,EAAC;MAFD,CAAV;MAGAC,WAAW;MACX,IAAImC,GAAG,GAAG,IAAIC,KAAJ,EAAV;MACAD,GAAG,CAACE,GAAJ,GAAU,WAAV;MACAH,GAAG,CAACpC,KAAJ,GAAUwC,IAAI,CAACC,KAAL,CAAWJ,GAAG,CAACrC,KAAJ,GAAY,IAAvB,CAAV;MACAoC,GAAG,CAACnC,MAAJ,GAAWuC,IAAI,CAACC,KAAL,CAAWJ,GAAG,CAACpC,MAAJ,GAAa,KAAxB,CAAX;MACAiC,cAAc,CAAEQ,SAAhB,CAA0BzD,UAA1B,EAAsCC,UAAtC,EAAkDkD,GAAG,CAACpC,KAAtD,EAA6DoC,GAAG,CAACnC,MAAjE;MACAkB,OAAO,CAACC,GAAR,CAAY,eAAZ,EAA4BnC,UAA5B,EAAwC,QAAxC,EAAkDC,UAAlD,EAZmB,CAY4C;;MAC/DmD,GAAG,CAACM,MAAJ,GAAa,YAAW;QACpB,IAAGxD,OAAO,KAAG,EAAV,IAAgBC,OAAO,KAAG,EAA7B,EAAgC;UAC5B8C,cAAc,CAAEU,SAAhB,CAA0BP,GAA1B,EAA+BlD,OAA/B,EAAwCC,OAAxC,EAAiDgD,GAAG,CAACpC,KAArD,EAA6DoC,GAAG,CAACnC,MAAjE;QAA0E;MACjF,CAHD;;MAIAkB,OAAO,CAACC,GAAR,CAAY,UAAZ,EAAuBjC,OAAvB,EAAgC,IAAhC,EAAsCC,OAAtC,EAjBmB,CAiB8B;MAEjD;;MACA,IAAG8C,cAAc,KAAK7C,OAAO,IAAE,CAAT,IAAcC,OAAO,IAAE,CAA5B,CAAjB,EAAgD;QAC5C4C,cAAc,CAACW,SAAf;QACAX,cAAc,CAACY,GAAf,CAAmBzD,OAAnB,EAA4BC,OAA5B,EAAqC,CAArC,EAAwC,CAAxC,EAA2C,IAAEkD,IAAI,CAACO,EAAlD;QACA5B,OAAO,CAACC,GAAR,CAAY,OAAZ,EAAqB7B,KAArB,EAH4C,CAGd;;QAC9B2C,cAAc,CAACc,SAAf,GAA2BzD,KAA3B;QACA2C,cAAc,CAACe,IAAf;QACAf,cAAc,CAACgB,MAAf;MACH,CAPD,MAOS;QAAC/B,OAAO,CAACC,GAAR,CAAY,uBAAZ;MAAqC;IAElD;;IACDN,cAAc;IACdO,cAAc;EACjB,CA/FQ,CAAT;EAiGA,oBACI;IAAA,uBACI;MAAQ,GAAG,EAAER,SAAb;MAAwB,MAAM,EAAEZ,MAAhC;MAAwC,KAAK,EAAED;IAA/C;MAAA;MAAA;MAAA;IAAA;EADJ;IAAA;IAAA;IAAA;EAAA,QADJ;AAMH,CApHD,C,CAsHA;;;IAtHMD,S;UAEkBJ,c;;;KAFlBI,S;AAuHNA,SAAS,CAACoD,YAAV,GAAyB;EACrBnD,KAAK,EAAE,GADc;EAErBC,MAAM,EAAE;AAFa,CAAzB;AAKA,eAAeF,SAAf"},"metadata":{},"sourceType":"module"}